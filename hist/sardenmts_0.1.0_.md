# Documentation for the `sARDenMTS` package.
  
----------------------------------------------------------------
 
 *sARDenMTS* 
  
----------------------------------------------------------------
 
### Version information:
  
- Package: sARDenMTS
- Version: 0.1.0
- Generated: 2025-12-08T21:54:58
- Author(s): Yutaka Morioka(sasyupi@gmail.com)
- Maintainer(s): Yutaka Morioka(sasyupi@gmail.com)
- License: MIT
- File SHA256: `F*07EA0273DDBCC0A9D10BF17FE2FF8B86908F508E008CFF642549A10B352CCAC4` for this version
- Content SHA256: `C*B1AFBA30CEDD927734A8DAEE05CD9DA0E0C9683BD2A9B893C95497FBADF6317B` for this version
  
---
 
# The `sARDenMTS` package, version: `0.1.0`;
  
---
 
A SAS-native authoring framework for CDISC Analysis Results Metadata Technical Specification (ARM-TS).
Users define ARS-compliant study, analysis, and output metadata via simple SAS macros that append to normalized metadata tables. The package validates key constraints and exports a hierarchical YAML ARM-TS file using yaml_writer.
Designed to integrate seamlessly with sARDen (ARD builder), with the longer-term goal of fully metadata-driven, reproducible TLF production. This integration layer is currently under active development.
  
---
 
  
---
 
Required SAS Components: 
  - Base SAS Software
  - yaml_writer
  
---
 
 
--------------------------------------------------------------------
 
*SAS package generated by SAS Package Framework, version `20250729`*
 
--------------------------------------------------------------------
 
# The `sARDenMTS` package content
The `sARDenMTS` package consists of the following content:
 
1. [`%ars_add_analysis()` macro ](#arsaddanalysis-macro-1 )
2. [`%ars_add_contrast()` macro ](#arsaddcontrast-macro-2 )
3. [`%ars_add_dataset()` macro ](#arsadddataset-macro-3 )
4. [`%ars_add_estimand()` macro ](#arsaddestimand-macro-4 )
5. [`%ars_add_group()` macro ](#arsaddgroup-macro-5 )
6. [`%ars_add_layout()` macro ](#arsaddlayout-macro-6 )
7. [`%ars_add_meta()` macro ](#arsaddmeta-macro-7 )
8. [`%ars_add_model()` macro ](#arsaddmodel-macro-8 )
9. [`%ars_add_multiplicity()` macro ](#arsaddmultiplicity-macro-9 )
10. [`%ars_add_output()` macro ](#arsaddoutput-macro-10 )
11. [`%ars_add_statistic()` macro ](#arsaddstatistic-macro-11 )
12. [`%ars_add_study()` macro ](#arsaddstudy-macro-12 )
13. [`%ars_add_variable()` macro ](#arsaddvariable-macro-13 )
14. [`%ars_init()` macro ](#arsinit-macro-14 )
15. [`%ars_write_yaml()` macro ](#arswriteyaml-macro-15 )
  
 
16. [License note](#license)
  
---
 
## `%ars_add_analysis()` macro <a name="arsaddanalysis-macro-1"></a> ######

Purpose    : Register analysis records linking outputs, estimands, and models  
               into ars.analysis. Supports multiple rows per call.  

  Usage      : Call once per output to define one or more analyses.  

  Parameters :  
    lib=          ARS library (default: ars).  
    output_id=    Output identifier to link analyses (required).  
    analysis_ids= Analysis IDs, '|' delimited (required).  
    estimand_ids= Estimand IDs per analysis, '|' delimited (required).  
    model_ids=    Model IDs per analysis, '|' delimited (required).  
    subset_ids=   Optional subset IDs per analysis, '|' delimited.  
    grouping_ids= Optional grouping IDs per analysis, '|' delimited.  
    labels=       Optional analysis labels, '|' delimited.  
    orders=       Optional analysis order, '|' delimited.  

  Output     : Adds one row per analysis to &lib..analysis.  

  Notes      : analysis_ids= length must match estimand_ids= and model_ids=.  

  Usage Example :  
    %ars_add_analysis(  
      output_id=T14_1_1,  
      analysis_ids=A0,  
      estimand_ids=E0,  
      model_ids=M0,  
      labels=%nrbquote(Baseline descriptive analysis),  
      orders=1  
    );

  
---
 
## `%ars_add_contrast()` macro <a name="arsaddcontrast-macro-2"></a> ######

Purpose    : Register contrast definitions for an analysis  
               into ars.contrast. Supports multiple rows per call.  

  Usage      : Call once per analysis_id to define one or more contrasts.  

  Parameters :  
    lib=            ARS library (default: ars).  
    analysis_id=    Analysis identifier (required).  
    contrast_ids=   Contrast IDs, '|' delimited (required).  
    types=          Contrast types per contrast, '|' delimited (required).  
    numerators=     Numerator groups, '|' delimited (optional).  
    denominators=   Denominator groups, '|' delimited (optional).  
    contrast_exprs= Contrast expressions, '|' delimited (optional).  
    labels=         Contrast labels, '|' delimited (optional).  

  Output     : Adds one row per contrast to &lib..contrast.  

  Notes      : contrast_ids= and types= counts must match.  

  Usage Example :  
    %ars_add_contrast(  
      analysis_id=A0,  
      contrast_ids=C0,  
      types=NONE,  
      labels=No treatment comparison  
    );

  
---
 
## `%ars_add_dataset()` macro <a name="arsadddataset-macro-3"></a> ######

Purpose    : Register dataset usage for an output into ars.dataset.  
               Supports multiple rows per call via pipe-delimited inputs.  

  Usage      : Call once per output to define all contributing domains.  

  Parameters :  
    lib=        ARS library (default: ars).  
    output_id=  Output identifier to link datasets (required).  
    domains=    List of dataset/domain names, '|' delimited (required).  
    roles=      List of roles per domain, '|' delimited (required).  
               Allowed: analysis|input|ref.  
    filters=    Optional list of WHERE/filter expressions per domain,  
               '|' delimited. If provided, count must match domains=.  

  Output     : Adds one row per domain to &lib..dataset.  

  Notes      : domains= and roles= counts must match; filters= optional.  

  Usage Example :  
    %ars_add_dataset(  
      output_id=T14_1_1,  
      domains=ADSL|ADVS|ADLB,  
      roles=analysis|input|input,  
      filters=%nrbquote(SAFFL='Y'|PARAMCD='SYSBP'|PARAMCD='GLUC')  
    );

  
---
 
## `%ars_add_estimand()` macro <a name="arsaddestimand-macro-4"></a> ######

Purpose    : Register estimand definitions for an analysis  
               into ars.estimand. Supports multiple rows per call.  

  Usage      : Call once per analysis_id to define one or more estimands.  

  Parameters :  
    lib=              ARS library (default: ars).  
    analysis_id=      Analysis identifier (required).  
    estimand_ids=     Estimand IDs, '|' delimited (required).  
    populations=      Populations per estimand, '|' delimited (required).  
    variables=        Target variables/endpoints, '|' delimited (required).  
    intercurrents=    Intercurrent event strategies, '|' delimited (optional).  
    summary_measures= Summary measures, '|' delimited (required).  
    analysis_methods= Analysis methods per estimand, '|' delimited (optional).  

  Output     : Adds one row per estimand to &lib..estimand.  

  Notes      : Required lists must be the same length.  

  Usage Example :  
    %ars_add_estimand(  
      analysis_id=A0,  
      estimand_ids=E0,  
      populations=ITT,  
      variables=Baseline demographics,  
      summary_measures=Descriptive summaries  
    );

  
---
 
## `%ars_add_group()` macro <a name="arsaddgroup-macro-5"></a> ######

Purpose    : Register grouping levels for an analysis into ars.group.  
               Supports multiple rows per call via pipe-delimited inputs.  

  Usage      : Call once per analysis_id to define group levels/order/filter.  

  Parameters :  
    lib=          ARS library (default: ars).  
    analysis_id=  Analysis identifier (required; scalar).  
    var_names=    Grouping variable names, '|' delimited (required).  
    level_values= Level values per row, '|' delimited (required).  
    level_labels= Level labels per row, '|' delimited (required).  
    level_orders= Level display order per row, '|' delimited (required).  
    level_filters=Optional row-level filters, '|' delimited.  

  Output     : Adds one row per level to &lib..group.  

  Notes      : All pipe-delimited lists must be the same length.  

  Usage Example :  
    %ars_add_group(  
      analysis_id=A0,  
      var_names=TRTA|TRTA,  
      level_values=DRUG|PBO,  
      level_labels=Drug|Placebo,  
      level_orders=1|2  
    );

  
---
 
## `%ars_add_layout()` macro <a name="arsaddlayout-macro-6"></a> ######

Purpose    : Register layout/section rules for an output  
               into ars.layout. Supports multiple rows per call.  

  Usage      : Call once per output to define header/body sections,  
               ordering, and split variables.  

  Parameters :  
    lib=        ARS library (default: ars).  
    output_id=  Output identifier (required).  
    sections=   Section names, '|' delimited (required).  
    row_orders= Row ordering per section, '|' delimited (required).  
    col_orders= Optional column ordering, '|' delimited.  
    headers=    Optional header expressions per section, '|' delimited.  
    split_vars= Optional split variable list per section, '|' delimited.  

  Output     : Adds one row per section to &lib..layout.  

  Notes      : sections= and row_orders= counts must match.  

  Usage Example :  
    %ars_add_layout(  
      output_id=T14_1_1,  
      sections=header|body_continuous,  
      row_orders=1|10,  
      headers=Treatment by Sex|Continuous variables,  
      split_vars=TRTA SEX|  
    );

  
---
 
## `%ars_add_meta()` macro <a name="arsaddmeta-macro-7"></a> ######

Purpose    : Add arbitrary key–value metadata for an output  
               into ars.meta_kv. Supports multiple rows per call.  

  Usage      : Use for free-form metadata not captured elsewhere.  

  Parameters :  
    lib=        ARS library (default: ars).  
    output_id=  Output identifier (required).  
    keys=       Metadata keys, '|' delimited (required).  
    values=     Metadata values, '|' delimited (required).  

  Output     : Adds one row per key to &lib..meta_kv.  

  Notes      : keys= and values= counts must match.  

  Usage Example :  
    %ars_add_meta(  
      output_id=T14_1_1,  
      keys=analysis_method|missing_display,  
      values=Descriptive only|Display missing as 'NA'  
    );

  
---
 
## `%ars_add_model()` macro <a name="arsaddmodel-macro-8"></a> ######

Purpose    : Register model specifications for an analysis  
               into ars.model. Supports multiple rows per call.  

  Usage      : Call once per analysis_id to define one or more models.  
               For descriptive analyses, use model_type=DESCRIPTIVE.  

  Parameters :  
    lib=                ARS library (default: ars).  
    analysis_id=        Analysis identifier (required).  
    model_ids=          Model IDs, '|' delimited (required).  
    model_types=        Model types, '|' delimited (required).  
    responses=          Response variables, '|' delimited (optional).  
    links=              Link functions, '|' delimited (optional).  
    dists=              Distributions, '|' delimited (optional).  
    fixed_effects_list= Fixed effects, '|' delimited (optional).  
    covariates_list=    Covariates, '|' delimited (optional).  
    random_effects_list=Random effects, '|' delimited (optional).  
    repeated_list=      Repeated measures specs, '|' delimited (optional).  
    cov_structures=     Covariance structures, '|' delimited (optional).  
    methods=            Estimation methods, '|' delimited (optional).  

  Output     : Adds one row per model to &lib..model.  

  Notes      : model_ids= and model_types= counts must match.  

  Usage Example :  
    %ars_add_model(  
      analysis_id=A0,  
      model_ids=M0,  
      model_types=DESCRIPTIVE,  
      methods=No inferential model  
    );

  
---
 
## `%ars_add_multiplicity()` macro <a name="arsaddmultiplicity-macro-9"></a> ######

Purpose    : Register multiplicity adjustment definitions for an analysis  
               into ars.multiplicity. Supports multiple rows per call.  

  Usage      : Call once per analysis_id to define multiplicity families.  

  Parameters :  
    lib=              ARS library (default: ars).  
    analysis_id=      Analysis identifier (required).  
    family_ids=       Family IDs, '|' delimited (required).  
    endpoint_ids=     Endpoint IDs per family, '|' delimited (required).  
    methods=          Adjustment methods per family, '|' delimited (required).  
    alphas=           Alpha levels per family, '|' delimited (optional).  
    orders=           Testing order per family, '|' delimited (optional).  
    condition_exprs=  Gatekeeping/condition expressions, '|' delimited (required).  
    notes_list=       Notes per family, '|' delimited (required).  

  Output     : Adds one row per family to &lib..multiplicity.  

  Notes      : All lists must be the same length.  

  Usage Example :  
    %ars_add_multiplicity(  
      analysis_id=A0,  
      family_ids=F0,  
      endpoint_ids=BASELINE,  
      methods=NONE,  
      alphas=.,  
      orders=.,  
      condition_exprs=,  
      notes_list=Not applicable  
    );

  
---
 
## `%ars_add_output()` macro <a name="arsaddoutput-macro-10"></a> ######

Purpose    : Register an output (TLF) definition into ars.output.  
               The output represents a Table, Listing, or Figure.  

  Usage      : Call once per output to define high-level display metadata.  

  Parameters :  
    lib=         ARS library (default: ars).  
    output_id=   Unique output identifier (required).  
    label=       Output title/label (required).  
    type=        Output type (required; Table|Listing|Figure).  
    purpose=     Brief intent/description (optional).  
    population=  Target population (optional).  
    analysis_set=Primary analysis dataset (optional).  

  Output     : Adds one row to &lib..output.  

  Notes      : type= is validated against the allowed enumeration.  

  Usage Example :  
    %ars_add_output(  
      output_id=T14_1_1,  
      label=Baseline characteristics,  
      type=Table,  
      purpose=Describe baseline demographics by treatment and sex,  
      population=ITT,  
      analysis_set=ADSL  
    );

  
---
 
## `%ars_add_statistic()` macro <a name="arsaddstatistic-macro-11"></a> ######

Purpose    : Register statistics to be displayed for an output  
               into ars.statistic. Supports multiple rows per call.  
  Usage      : Call once per output to define all required stats.  
  Parameters :  
    lib=          ARS library (default: ars).  
    output_id=    Output identifier (required).  
    stats=        Statistic names, '|' delimited (required).  
    labels=       Display labels, '|' delimited (required).  
    methods=      Computation methods, '|' delimited (required).  
    orders=       Display order, '|' delimited (required).  
    decimals=     Decimal places, '|' delimited (required).  
    footnote_ids= Optional footnote IDs per statistic, '|' delimited.  
  Output     : Adds one row per statistic to &lib..statistic.  
  Notes      : All provided lists must be the same length.  
  Usage Example :  
    %ars_add_statistic(  
      output_id=T14_1_1,  
      stats=N|MEAN|SD,  
      labels=n|Mean|SD,  
      methods=COUNT|MEAN|STD,  
      orders=1|2|3,  
      decimals=0|1|1  
    );

  
---
 
## `%ars_add_study()` macro <a name="arsaddstudy-macro-12"></a> ######

Purpose    : Register study-level metadata into ars.study.  
               Appends one observation describing the study.  

  Usage      : Call once per study to seed ARM-TS study section.  

  Parameters :  
    lib=         ARS library (default: ars).  
    study_id=    Study identifier (required).  
    protocol_id= Protocol identifier (required).  
    title=       Study title (required).  
    version=     Metadata version label (required).  
    created_by=  Author/creator name (optional).  
    created_on=  Creation date (default: today in YYYY-MM-DD).  

  Output     : Adds one row to &lib..study.  

  Usage Example :  
    %ars_add_study(  
      lib=ars,  
      study_id=STUDY001,  
      protocol_id=ABC-123,  
      title=%nrstr(A Randomized, Double-blind Study of XYZ in Hypertension),  
      version=v1.0,  
      created_by=Yutaka Morioka  
    );

  
---
 
## `%ars_add_variable()` macro <a name="arsaddvariable-macro-13"></a> ######

Purpose    : Register display variables for an output into ars.variable.  
               Supports multiple rows per call via pipe-delimited inputs.  

  Usage      : Call once per output to define BY/ROW/COL/STAT variables.  

  Parameters :  
    lib=         ARS library (default: ars).  
    output_id=   Output identifier to link variables (required).  
    vars=        Variable names, '|' delimited (required).  
    labels=      Variable labels, '|' delimited (required).  
    types=       num|char per variable, '|' delimited (required).  
    roles=       by|row|col|stat per variable, '|' delimited (required).  
    formats=     Optional SAS formats per variable, '|' delimited.  
    derivations= Optional derivation text per variable, '|' delimited.  

  Output     : Adds one row per variable to &lib..variable.  

  Notes      : Counts across vars/labels/types/roles must match.  

  Usage Example :  
    %ars_add_variable(  
      output_id=T14_1_1,  
      vars=TRTA|SEX|AGE,  
      labels=Treatment|Sex|Age (years),  
      types=char|char|num,  
      roles=by|by|row,  
      formats=$trt.|$sex.|8.1  
    );

  
---
 
## `%ars_init()` macro <a name="arsinit-macro-14"></a> ######

Purpose    : Initialize the ARS metadata environment.  
               This macro assigns the ARS library, defines internal  
               utility macros for validation and error handling, and  
               creates empty ARS metadata tables if they do not exist.  
  Usage      : Call once at the start of a session or inside any ARS  
               authoring macro to guarantee required tables exist.  

  Parameters :  
    lib=      LIBREF for ARS metadata tables.  
              Default: ars.  
    libpath=  Physical path for the ARS library.  
              The directory is created if it does not exist.  

  Tables Created if Missing :  
    study        Study-level metadata.  
    output       Output/display definitions.  
    dataset      Input/analysis dataset references.  
    variable     Display variable roles and derivations.  
    statistic    Displayed statistics and formatting.  
    layout       Layout/sectioning rules.  
    meta_kv      Free key–value metadata.  
    model        Analysis model specifications.  
    estimand     Estimand definitions per analysis.  
    contrast     Contrast definitions per analysis.  
    multiplicity Multiplicity adjustment definitions.  
    analysis     Bridge linking outputs to analyses and core analysis info.  
    group        Grouping level definitions (ordering/labels).  

  Usage Example :  
    Set a permanent ARS library and initialize all metadata tables.  
      %ars_init(  
        lib=ars,  
        libpath=F:\project\metadata\ars  
      );  

  Notes      :  
    This macro is idempotent. Repeated calls re-assign the library  
    and only create tables that are absent.

  
---
 
## `%ars_write_yaml()` macro <a name="arswriteyaml-macro-15"></a> ######

Purpose    : Export ARS metadata tables into a hierarchical ARM-TS YAML file.  
               The macro gathers unique analyses and outputs, builds the  
               analysis–output relationship list, and emits YAML using  
               yaml_writer utilities.  

  Usage      : Run after populating ars.* metadata tables (study, analysis,  
               estimand, model, contrast, multiplicity, group, output,  
               dataset, variable, statistic, meta_kv).  

  Parameters :  
    lib=      ARS library containing normalized metadata tables  
              (default: ars).  
    outpath=  Output folder for the YAML file (required).  
    outfile=  Output YAML file name without extension (required).  

  Required Supporting Package (Macros) :  
  [yaml_writer]
  https://github.com/PharmaForest/yaml_writer
    %yaml_start(outpath=, file=)  
    %yaml_end()  
    %dataset_export(ds=, wh=, cat=, varlist=, indent=, keyvar=)  

  Output     : Creates &outpath./&outfile..yaml and intermediate WORK tables.  

  Notes      :  
    - analyses are emitted as a YAML sequence under "analyses".  
    - outputs are emitted as a YAML sequence under "outputs".  
    - analysis_refs per output are derived from ars.analysis.  

  Usage Example :  
    %ars_write_yaml(  
      lib=ars,  
      outpath=F:\project\metadata,  
      outfile=armts_metadata  
    );

  
---
 
  
---
 
# License <a name="license"></a> ######
 
	Copyright (c) [2025]  [Yutaka Morioka]

Permission is hereby granted, free of charge, to any person obtaining a copy   
of this software and associated documentation files (the "Software"), to deal    
in the Software without restriction, including without limitation the rights   
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell   
copies of the Software, and to permit persons to whom the Software is   
furnished to do so, subject to the following conditions:                      
                                                                                
The above copyright notice and this permission notice shall be included       
in all copies or substantial portions of the Software.                        
                                                                                
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR    
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,      
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE   
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER        
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE 
SOFTWARE.
  
---
 
